{% extends "base.html" %} 
{% load widget_tweaks %} {% comment %} for adding datepicker class to form.date for materialize {% endcomment %} 
{% block content %}
<div class="container">
    <form method="POST" class="post-form">{% csrf_token %}        
        <div class="row">
                        <div style="display:none"> <h3> {{ form.franchise }} </h3></div>
            <div class="col s-2 fieldWrapper">
                {{ form.title.errors }}
                <label for="{{ form.title.id_for_label }}">Title:</label> {{ form.title }}
            </div>
            <div class="col s-2 fieldWrapper">
                    {{ form.first_name.errors }}
                    <label for="{{ form.first_name.id_for_label }}">First Name:</label> {{ form.first_name }}
            </div>
            <div class="col s-3 fieldWrapper">
                    {{ form.last_name.errors }}
                    <label for="{{ form.last_name.id_for_label }}">Last Name:</label> {{ form.last_name }}
                </div>
            <div class="col s-3 fieldWrapper">
                    {{ form.email.errors }}
                    <label for="{{ form.email.id_for_label }}">Email:</label> {{ form.email }}
            </div>
            
            <div class="col s-2 fieldWrapper">
                {{ form.mobile.errors }}
                <label for="{{ form.mobile.id_for_label }}">Mobile:</label> {{ form.mobile }}
            </div>
            <div class="col s-2 fieldWrapper">
                    {{ form.frequency.errors }}
                    <label for="{{ form.frequency.id_for_label }}">Frequency:</label> {{ form.frequency }}
                </div>
        </div>
        <div class="row">
            <div class="col s-4 fieldWrapper">
                    {{ form.address_line_1.errors }}
                    <label for="{{ form.address_line_1.id_for_label }}">Address Line 1:</label> {{ form.address_line_1 }}
            </div>
            <div class="col s-4 fieldWrapper">
                    {{ form.address_line_2.errors }}
                    <label for="{{ form.address_line_2.id_for_label }}">Address Line 2:</label> {{ form.address_line_2 }}
            </div>
            <div class="col s-4 fieldWrapper">
                    {{ form.address_line_3.errors }}
                    <label for="{{ form.address_line_3.id_for_label }}">Address Line 3:</label> {{ form.address_line_3 }}
            </div>
        </div>
        <div class="row">
            <div class="col s-4 fieldWrapper">
                    {{ form.city.errors }}
                    <label for="{{ form.city.id_for_label }}">City:</label> {{ form.city }}
            </div>
            <div class="col s-4 fieldWrapper">
                    {{ form.county.errors }}
                    <label for="{{ form.county.id_for_label }}">County:</label> {{ form.county }}
            </div>
            <div class="col s-4 fieldWrapper">
                    {{ form.postcode.errors }}
                    <label for="{{ form.postcode.id_for_label }}">Postcode:</label> {{ form.postcode }}
            </div>
            
        </div>
        <div class="row">
                <div class="col s-12 fieldWrapper">
                        {{ form.customer_notes.errors }}
                        <label for="{{ form.customer_notes.id_for_label }}">Customer Notes:</label> {{ form.customer_notes }}
                </div>
        </div>
        <div class="row">
                <div class="col s-12 fieldWrapper">
                        {{ form.property_type.errors }}
                        <label for="{{ form.property_type.id_for_label }}">Property Type:</label> {{ form.property_type }}
                </div>
        </div>

       
        
    <div class="col s-8">
            <button class="btn waves-effect waves-light left" type="submit" name="action">Save
    <i class="material-icons right">check_circle</i>
    </button>
</form>
{% if not form.instance.id %}
<a href="{% url 'customers' %}" class="waves-effect waves-light btn red right"><i class="material-icons right">cancel</i>Cancel</a>
{% endif %}
</div>

{% if form.instance.id %}
<!-- Modal Trigger -->
<div class="col s-2">
    <a class="waves-effect waves-light btn modal-trigger red right" href="#modal_confirm"><i class="material-icons right">delete</i>Delete</a>
</div>


<!-- Modal Structure -->
<div id="modal_confirm" class="modal bottom-sheet">
    <div class="modal-content">
        <h5>Are you sure you want to delete this customer?</h5><br>
        <div class="row">
            <form method="POST" class="post-form" action="{% url 'customer_delete' customer.id %}">{% csrf_token %}
                <button class="btn waves-effect waves-light left red" type="submit" name="action">
                Yes, delete</button>
            </form>
            <a href="#!" class="btn waves-effect waves-light right modal-action modal-close">
                    Cancel</a>
        </div>
    </div>
</div>
{% endif %}
{% endblock %} 

{% block extra_js %}
<script>
    $('.datepicker').pickadate({
        selectMonths: true, // Creates a dropdown to control month
        selectYears: 15, // Creates a dropdown of 15 years to control year,
        today: 'Today',
        clear: 'Clear',
        close: 'Ok',
        closeOnSelect: true,// Close upon selecting a date,
        format: 'mm/dd/yyyy'
    });
    //TODO: with several $(document).ready(function() they get called in order; 
    // would be nice to append to the function defined in base.html instead
    // of having several.

    $(document).ready(function () {
        // the "href" attribute of the modal trigger must specify the modal ID that wants to be triggered
        $('.modal').modal();
    });

</script>
{% endblock %}